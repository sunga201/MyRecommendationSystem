# 사용자에게 음악을 추천해주는 추천 엔진
사용자가 음악들에 매긴 평점 정보를 이용하여, 사용자가 선호할만한 음악을 추천해주는 프로그램입니다. 사용자가 자신의 아이디를 입력하면, 기존에 평점을 남기지 않았던 음악들 중 사용자의 취향에 맞는 새로운 음악을 추천받을 수 있습니다.  

학습 데이터로는 Amazon에서 제공하는 [음악 평점 데이터](https://github.com/sunga201/MyRecommendationSystem/tree/master/%EC%BD%94%EB%93%9C/reviewData/Digital_Music_5.json)를 활용했습니다. 여기에는 3500명의 사용자가 남긴 약 64,000개의 평점 및 리뷰 데이터가 들어있습니다.

데이터 출처 : https://jmcauley.ucsd.edu/data/amazon/



</br></br>

## 기능
관리자 모드
 * 기존 평점 정보를 이용하여 예측 평점 행렬을 구할 수 있습니다.

   * Stochastic Gradient Descent(SGD)
   * 크기가 128인 minibatch를 이용한 SGD

 * 계산한 예측 평점 행렬은 파일로 저장되며, 재실행 시 추가적인 계산과정 없이 바로 서비스를 이용할 수 있습니다.

 * 예측 평점 행렬 계산 과정에서 발생한 오차를 그래프의 형태로 확인할 수 있습니다.

 </br>

 <p align = center><img src="이미지/에러 그래프.png" height="350px" alt="error-graph"></img></p>
 <br/>      

</br>

 * RMSE 값을 이용한, 단순 item-item collaborative filtering 기법과의 성능 비교를 제공합니다.


</br>

사용자 모드
 * 아이디를 입력하여 추천 음악 목록을 관련 키워드와 함께 확인할 수 있습니다.

 * 추천 목록에서 특정 음악을 삭제할 수 있습니다. 

 * 인기 차트에서 선호하는 음악을 선택하면, 예측 평점 행렬에 반영되어 유사한 음악을 추천받을 수 있습니다.

 * 사용자들이 음악들에 남긴 리뷰에서 그 음악과 관련된 키워드를 뽑아내고, 이를 추천 목록에서 보여줄 수 있습니다.

 </br></br>


## 사용 방법
  </br>

  이 프로그램에는 두 가지 모드가 존재합니다.

  </br>

  ### 관리자 모드
  관리자 모드에서는 예측 평점 행렬을 계산 하는 것과 관련된 기능을 수행합니다. 사용자 모드를 이용하기 위해서는 먼저 여기서 예측 평점 행렬을 계산해야 합니다.

       
<details>
<summary> 자세히 보기 </summary>

  > 1. 예측 평점 행렬 구하기  
      미리 주어진 평점 데이터를 이용해 사용자가 평점을 남기지 않은 나머지 음악들에 대한 예측 평점을 구할 수 있습니다. 구한 평점 행렬은 파일로 저장되어 다음에 프로그램을 실행했을 때 다시 예측 평점 행렬을 계산하지 않아도 사용자 모드를 이용할 수 있습니다.</br>  
      평점 행렬을 계산하는 방법은 일반적인 Stochastic gradient descent(SGD) 기법과 minibatch를 이용한 SGD 기법이 제공됩니다. 

  > 2. 예측 평점 행렬 확인  
      1에서 구한 평점 행렬을 확인할 수 있습니다.

  > 3. 에러 그래프 출력  
      예측 평점 행렬을 구하면서 기록한 RMSE 값을 그래프의 형태로 보여줍니다. 초반 iteration에는 빠르게 RMSE 값이 감소하다가, 점차 0.8과 가까운 값으로 수렴하는 것을 확인할 수 있습니다.

  > 4. RMSE 비교  
      이 프로그램에서 구한 예측 평점 행렬의 최종 RMSE 값과 단순 Item-Item collaborative filtering 기법으로 구한 예측 평점 행렬의 RMSE 값을 출력합니다.

  > 5. 초기 평점 행렬 파일 제거  
      리뷰 데이터를 이용해 생성한 초기 평점 행렬 파일을 제거합니다. 
  
</div>
</details>
</br></br>

  ### 사용자 모드

  사용자모드에서는 내 취향에 맞는 새로운 음악을 추천받거나, 추천 목록에서 취향에 맞지 않는 음악을 제거할 수 있습니다. 사용자 모드를 이용하기 위해서는 먼저 관리자 모드에서 예측 평점 행렬을 구해야 합니다.


  모든 기능에는 아이디가 필요하며, 아이디는 [데이터 소스](https://github.com/sunga201/MyRecommendationSystem/tree/master/%EC%BD%94%EB%93%9C/reviewData/Digital_Music_5.json)의 "reviewerID"에서 확인하실 수 있습니다.  
  추천되는 음악은 ID 형태로 출력됩니다.

  ### 1. 나에게 맞는 음악을 추천받고 싶을 때 
  </br>

    1. 아이디를 입력하여 사용자 메뉴로 들어가 '추천 목록 출력'을 선택합니다.

    2. 표시할 항목 수를 입력하면 내가 평점을 매기지 않은 음악들을 예측 평점이 높은 순으로 정렬해서 관련 키워드와 함께 확인할 수 있습니다. 

 <p align = center><img src="이미지/추천 목록.png" height="400px" alt="recommand-list"></img></p>

</br>

  ### 2. 추천받은 음악 목록 중에 마음에 들지 않는 음악이 있는 경우
  </br>

    1.아이디를 입력하여 사용자 메뉴로 들어가 "추천 목록에서 특정 항목 제거 하기"를 선택합니다.

    2. 기존에 "추천 목록 출력"을 수행한 적이 있었다면 그 목록을 화면에 표시합니다. 
    수행한 적이 없었다면 추천받을 음악의 수를 입력받고 그 수만큼 추천 목록을 표시합니다.

    3.추천 목록에서 제거하고 싶은 음악의 번호를 입력하면 그 음악은 추천목록에서 사라집니다. 이 음악과 20 퍼센트 이상 유사한 음악은 유사도에 비례해서 예측 평점 값이 줄어들게 됩니다. 이것으로 선호하지 않는 음악과 유사한 음악도 추천 목록에서 지울 수 있습니다.
    
  ### 3. 인기 차트에서 마음에 드는 음악을 선택하는 경우
    1.아이디를 입력하여 사용자 메뉴로 들어가 "인기곡으로부터 추천받기"를 선택합니다.  

    2. 마음에 드는 음악을 선택하면 이와 유사한 음악을 추천해주고, 그 음악들의 예측 평점을 올려줍니다.
  </br>

 </br></br>


## 어려웠던 점
  1. 예측 평점의 평점 범위 초과 문제

  2. 추천 목록 순서가 매 학습마다 바뀌는 문제

  3. 음악과 관련된 키워드를 추출하는 문제

 </br></br>

## 팀원
  홍성현 외 1인

 </br></br>
 

## 담당 업무
> 모델 기반의 Matrix factorization을 사용한 예측 평점 행렬 구현

> TF-IDF 기법을 이용하여 각각의 음악과 관련된 단어 추출
  
> RMSE 값을 이용한 추천 엔진 성능 측정
> 


</br></br>

## 사용 언어
 > Python3
 
 </br></br>

## 사용 라이브러리
 > matplotlib

 > numpy

 > scipy

 > Cython

 > scikit-learn
 
 </br></br>




## 실행 방법
   [코드](https://github.com/sunga201/MyRecommendationSystem/tree/2021/01/17_revise/%EC%BD%94%EB%93%9C) 폴더에서
   1. 콘솔 창에 pip install -r requirements.txt
   2. 콘솔 창에 recommendation_menu.py
   